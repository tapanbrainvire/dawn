<style>
  #product-list{
    display: flex;
    flex-flow: row wrap;
    margin: 0 10%;
    justify-content: space-between;
    align-items: center;
}
  .product-item {
    width: 22%;
}
  .product-item img{
    width:100%;
  }
.product-item h2{
    font-size: 15px;
    font-weight: bold;
}
</style>

<div class="tp-custom-collection-container">
  <div class="tp-custom-filters">
    <!-- Filter by Tags -->
    <div class="tp-filter-option-tags">
      <h3>Filter by Tags</h3>
      <ul>
        {% assign tags = collections['collection-handle'].all_tags %}
        {% for tag in tags %}
          <li>
            <label>
              <input type="checkbox" class="filter-tag" value="{{ tag }}">
              {{ tag }}
            </label>
          </li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div id="product-list"></div>


  {% comment %}
  {% for product in collections[collection.handle].products %}
  <div class="product-item">
    <img src="{{ product.featured_image | img_url: 'master' }}" />
    <h2>{{ product.title }}</h2>
    <p>{{ product.price | money }}</p>
    <a href="{{ product.url }}">View Product</a>
  </div>
{% endfor %}
  {% endcomment %}

  
</div>

{% schema %}
{
  "name": "Custom Product Grid",
  "class": "section",
  "settings": [
  ]
}
{% endschema %}

<script>
  // Function to fetch all products from a specific collection
  function fetchProductsByCollection() {
    const apiUrl = '/collections/{{ collection.handle }}/products.json';

    // Make AJAX request to fetch products
    fetch(apiUrl)
      .then(response => response.json())
      .then(data => {
        const products = data.products;
        displayProducts(products.slice(0, 9)); // Display only the first 9 products
      })
      .catch(error => {
        console.error('Error fetching products:', error);
      });
  }

  // Function to display products on the page
  function displayProducts(products) {
    const productContainer = document.getElementById('product-list');
    productContainer.innerHTML = ''; // Clear previous products

    products.forEach(product => {
      const productHTML = `
        <div class="product-item">
          <img src="${product.images[0].src}" alt="${product.title}" />
          <h2>${product.title}</h2>
          <p>${product.variants[0].price}</p>
          <a href="/products/${product.handle}">View Product</a>
        </div>
      `;
      productContainer.innerHTML += productHTML;
    });
  }

  // Call the function with your desired collection handle
  fetchProductsByCollection(); // Replace with your collection handle
</script>
